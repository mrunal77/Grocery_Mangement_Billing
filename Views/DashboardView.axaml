<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:GroceryStore.ViewModels"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d" d:DesignWidth="1000" d:DesignHeight="700"
             x:Class="GroceryStore.Views.DashboardView"
             x:DataType="vm:DashboardViewModel">

    <ScrollViewer>
        <StackPanel Margin="32" Spacing="24">
            <!-- Welcome Section -->
            <Border CornerRadius="16" Padding="32">
                <Border.Background>
                    <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,0%">
                        <GradientStop Offset="0" Color="#2E7D32"/>
                        <GradientStop Offset="1" Color="#4CAF50"/>
                    </LinearGradientBrush>
                </Border.Background>
                <Grid ColumnDefinitions="*,Auto">
                    <StackPanel Grid.Column="0">
                        <TextBlock Text="Welcome Back!" FontSize="28" FontWeight="Bold" Foreground="White"/>
                        <TextBlock Text="Here's what's happening with your store today" FontSize="14" Foreground="#C8E6C9" Margin="0,8,0,0"/>
                    </StackPanel>
                    <Border Grid.Column="1" Background="#FFFFFF20" CornerRadius="50" Padding="16">
                        <PathIcon Data="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z" Foreground="White" Width="32" Height="32"/>
                    </Border>
                </Grid>
            </Border>

            <!-- Stats Cards -->
            <Grid ColumnDefinitions="*,*,*,*" RowDefinitions="Auto">
                <Border Grid.Column="0" Classes="card" Margin="0,0,16,0">
                    <Grid ColumnDefinitions="Auto,*">
                        <Border Grid.Column="0" Background="#E8F5E9" CornerRadius="12" Padding="14" Margin="0,0,16,0">
                            <PathIcon Data="M20 2H4c-1 0-2 1-2 2v3.01c0 .72.43 1.34 1 1.69V20c0 1.1 1.1 2 2 2h14c.9 0 2-.9 2-2V8.7c.57-.35 1-.97 1-1.69V4c0-1-1-2-2-2zm-5 12H9v-2h6v2zm5-7H4V4l16-.02V7z" Foreground="#2E7D32" Width="24" Height="24"/>
                        </Border>
                        <StackPanel Grid.Column="1" VerticalAlignment="Center">
                            <TextBlock Text="Total Products" FontSize="13" Foreground="#757575"/>
                            <TextBlock Text="{Binding TotalProducts}" FontSize="28" FontWeight="Bold" Foreground="#212121"/>
                        </StackPanel>
                    </Grid>
                </Border>
                
                <Border Grid.Column="1" Classes="card" Margin="8,0">
                    <Grid ColumnDefinitions="Auto,*">
                        <Border Grid.Column="0" Background="#E3F2FD" CornerRadius="12" Padding="14" Margin="0,0,16,0">
                            <PathIcon Data="M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-2-2z" Foreground="#1976D2" Width="24" Height="24"/>
                        </Border>
                        <StackPanel Grid.Column="1" VerticalAlignment="Center">
                            <TextBlock Text="Categories" FontSize="13" Foreground="#757575"/>
                            <TextBlock Text="{Binding TotalCategories}" FontSize="28" FontWeight="Bold" Foreground="#212121"/>
                        </StackPanel>
                    </Grid>
                </Border>
                
                <Border Grid.Column="2" Classes="card" Margin="8,0">
                    <Grid ColumnDefinitions="Auto,*">
                        <Border Grid.Column="0" Background="#FFF3E0" CornerRadius="12" Padding="14" Margin="0,0,16,0">
                            <PathIcon Data="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14h-2V9h2v8zm-2-10V5h2v2h-2z" Foreground="#FF6F00" Width="24" Height="24"/>
                        </Border>
                        <StackPanel Grid.Column="1" VerticalAlignment="Center">
                            <TextBlock Text="Today's Sales" FontSize="13" Foreground="#757575"/>
                            <TextBlock Text="{Binding TodaySales, StringFormat='${0:F2}'}" FontSize="28" FontWeight="Bold" Foreground="#FF6F00"/>
                        </StackPanel>
                    </Grid>
                </Border>
                
                <Border Grid.Column="3" Classes="card" Margin="16,0,0,0">
                    <Grid ColumnDefinitions="Auto,*">
                        <Border Grid.Column="0" Background="#FCE4EC" CornerRadius="12" Padding="14" Margin="0,0,16,0">
                            <PathIcon Data="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z" Foreground="#C2185B" Width="24" Height="24"/>
                        </Border>
                        <StackPanel Grid.Column="1" VerticalAlignment="Center">
                            <TextBlock Text="Transactions" FontSize="13" Foreground="#757575"/>
                            <TextBlock Text="{Binding TodayTransactions}" FontSize="28" FontWeight="Bold" Foreground="#212121"/>
                        </StackPanel>
                    </Grid>
                </Border>
            </Grid>

            <!-- Low Stock Alert -->
            <Border Classes="card" IsVisible="{Binding LowStockProducts.Count}" BorderBrush="#FFCDD2" BorderThickness="1">
                <StackPanel>
                    <StackPanel Orientation="Horizontal" Spacing="12" Margin="0,0,0,16">
                        <Border Background="#FFEBEE" CornerRadius="8" Padding="10">
                            <PathIcon Data="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z" Foreground="#D32F2F" Width="20" Height="20"/>
                        </Border>
                        <TextBlock Text="Low Stock Alert" FontSize="18" FontWeight="SemiBold" Foreground="#D32F2F" VerticalAlignment="Center"/>
                    </StackPanel>
                    <ItemsControl ItemsSource="{Binding LowStockProducts}">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <WrapPanel/>
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Background="#FFEBEE" CornerRadius="8" Padding="12,8" Margin="0,0,8,8">
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <TextBlock Text="{Binding Name}" VerticalAlignment="Center"/>
                                        <TextBlock Text="-" Foreground="#D32F2F" VerticalAlignment="Center"/>
                                        <TextBlock Text="{Binding Quantity, StringFormat='{}{0} left'}" Foreground="#D32F2F" FontWeight="Medium" VerticalAlignment="Center"/>
                                    </StackPanel>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </StackPanel>
            </Border>

            <!-- Recent Transactions -->
            <Border Classes="card">
                <StackPanel>
                    <StackPanel Orientation="Horizontal" Spacing="12" Margin="0,0,0,20">
                        <Border Background="#E8F5E9" CornerRadius="8" Padding="10">
                            <PathIcon Data="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z" Foreground="#2E7D32" Width="20" Height="20"/>
                        </Border>
                        <TextBlock Text="Recent Transactions" FontSize="18" FontWeight="SemiBold" VerticalAlignment="Center"/>
                    </StackPanel>
                    
                    <DataGrid ItemsSource="{Binding RecentTransactions}"
                              AutoGenerateColumns="False"
                              IsReadOnly="True"
                              GridLinesVisibility="Horizontal"
                              BorderThickness="0"
                              MinHeight="200"
                              Background="White"
                              Foreground="#212121">
                        <DataGrid.Columns>
                            <DataGridTemplateColumn Header="" Width="50">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Border Background="#E8F5E9" CornerRadius="6" Padding="8" HorizontalAlignment="Center">
                                            <PathIcon Data="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14h-2V9h2v8zm-2-10V5h2v2h-2z" Foreground="#2E7D32" Width="16" Height="16"/>
                                        </Border>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="60"/>
                            <DataGridTextColumn Header="Date" Binding="{Binding Date, StringFormat='{}{0:MMM dd, yyyy HH:mm}'}" Width="*"/>
                            <DataGridTextColumn Header="Items" Binding="{Binding Items.Count}" Width="80"/>
                            <DataGridTemplateColumn Header="Total" Width="100">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding TotalAmount, StringFormat='${0:F2}'}" FontWeight="SemiBold" Foreground="#2E7D32"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </StackPanel>
            </Border>
        </StackPanel>
    </ScrollViewer>
</UserControl>
